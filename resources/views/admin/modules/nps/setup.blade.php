<style>
    b, strong {	font-weight: 500!important;}
    .radio, .checkbox{display: inline-block; margin-right: 30px;}
    .btn-info, .btn-info:hover, .btn-info:focus{	background: #2196F3; border: 1px solid #2196F3;}
    .form-wizard-count{border: 2px solid #2196F3; color:#2196F3;	}
    fieldset.step {	min-height: 300px; margin-bottom: 0px; padding: 20px 0!important;}
    .progressbar {	width: 100%;	position: absolute;	left: 0;	bottom: -5px;}
    .progress{border-radius: 0px; height: 6px;}
    .form-group{margin-bottom: 15px;}
    .form-wizard-title{border: none!important; display: none!important;}
    .panel-body{padding: 20px!important;}
    .panel-heading{border-bottom: 1px solid #f5f4f5;}
    .w50m0 .panel{/*min-height: 1492px;*/ margin: 0;}
    .video_review{border: none; box-shadow: 0 0px 19px 0 rgba(0, 0, 0, 0.15); margin: 47px auto;}
    .right_content{max-width: 100%;}
    textarea.form-control{height: 60px;}
    .comm_text{float: left; display: inline-block; width: 190px; margin: 8px 0;}
    .checkbox.checkbox-switchery {margin-bottom: 0px!important;padding-left: 0!important;float: left!important;}



    .txt_inp_grp .input-circle {  border: 1px solid #cccccc;  border-radius: 5px!important; margin: 0 0 0 0px!important; width: 60px; z-index:0;}
    .txt_inp_grp select.camp {  -moz-appearance: none;  background: #dddddd none repeat scroll 0 0;  border: medium none;  border-radius: 5px; width: 120px; margin: 0 25px;}
    .txt_inp_grp p, .txt_inp_grp input, .txt_inp_grp select{display: inline-block;}
    .newactive{ display:inline-block; color:#fff; border-radius:4px; background-color: #4CAF50; padding:0.5px 10px 0.5px 10px; }
    .draft{ display:inline-block; color:#000; border-radius:4px; background-color: #e4e4e4; padding:0.5px 10px 0.5px 10px; }
    .inactive{ display:inline-block; color:#fff; border-radius:4px; background-color:#FF0000; padding:0.5px 10px 0.5px 10px; }
    .points{cursor: pointer;}
    .green {color: #ffffff !important;}
    .btn.green, .btn.green .fa {        color: #fff !important;    }
    .page-content-wrapper .page-content{max-width: 1350px;}
    .draft{padding: 6px 12px!important;}
    .eventDiv{margin-top:0px;}
    .updateevent{margin-top:0px!important; }
    .btn.green{background: #0190e6 !important; color: #fff!important; width: 100px!important;}
    .btn.red{background: #f30000  !important; color: #fff!important;}
    .btn.green_cust_btn{/*width: 100px!important;*/}
    .step_star ul > li.star > i.fa{font-size: 30px!important;}
    .video_review h4.review{margin: 23px 0!important;}
    .pl50{padding-left: 30px;}
    .pr50{padding-right: 30px;}
    .panel.blue_bkg{ box-shadow: none!important;border-left: none !important;border-right: none!important;margin: -1px -20px 0px; border-bottom: none!important;}


    .panel.blue_bkg .panel-body{padding: 0px 0!important;}
    .blue_bkg .panel-heading{border-bottom: 1px solid #f5f4f5!important; background: #f7fbfe!important;}
    .media-right.text-nowrap{padding-left: 10px!important;}
    .modal-lg {width: 1200px;}
    .wysihtml5-sandbox{width: 100%; max-width: 100%!important; height: 180px!important;}
    .bg-blue.btn-block{margin-top: 3px;}
    .media-heading.title{line-height: 20px;}

    .fa.fontimgicon {
        background: #ebf4fb;
        width: 30px;
        height: 30px;
        font-size: 14px!important;
        text-align: center;
        line-height: 28px;
        border-radius: 100px; color: #9cc5e8!important;
    }


    .media-right .btn-block{ margin-top: 25px!important; width:100px!important}
    .offsite.img-lg{width:60px!important; height: 60px!important; border-radius: 100%!important; }
    .grbtn{position: absolute; right:-40px; top: 0; z-index: 1;}
    hr{border-color: #eeeeee!important;}
    .content.offsite_feed{padding: 0!important; margin: 0 -20px!important;}
    .content.offsite_feed .panel.panel-flat{ border: none!important; box-shadow: none!important;}
    .editable-buttons .btn.btn-primary{ background: #fff!important; border: 1px solid #2196f3!important; color: #2196f3!important; cursor: pointer;}
    .editable-buttons .btn.btn-primary:hover{background: #2196f3!important; color: #fff!important;}
    .editable-buttons .btn.btn-default{ background: #fff!important; border: 1px solid #f30000!important; color: #f30000 !important; cursor: pointer;}
    .editable-buttons .btn.btn-default:hover{background: #f30000 !important; color: #fff!important;}
    .media-right.text-nowrap .bl_cust_btn:focus{background: #2196f3!important; color: #fff!important;}
    .media-right.text-nowrap .red_cust_btn:focus{background: #f30000 !important; color: #fff!important;}
    select.daysnumber{position: absolute; top: -8px; left: 200px!important; width: 85px;}
    input.daysnumber2{position: absolute; top: -8px; left: 115px!important; width: 70px;}
    .dropzone .dz-default.dz-message::before {font-size: 50px;top: 70px;}
    .dropzone .dz-default.dz-message span {margin-top: 115px;}
    .tabReviews{padding: 0 0 60px 0!important; margin: 0 -20px!important;}
    .tabReviews .datatable-footer, .tabReviews .datatable-header{padding:20px 20px 0!important;}
    .tabReviews .panel{box-shadow: none!important; border: none!important;}
    p.emaildata{width: 100%; display: block;  margin: 2px 0; line-height: 17px;}
    p.emaildata strong{ float: left; width: 75px; display: block; font-weight: 600!important;}
    p.emaildata span{font-size: 11px!important;}
    p.emaildata.inner strong{ font-weight: 400!important; font-size: 12px!important;}

    .emaildata_top p{font-weight: 500!important; font-size: 13px;}
    .tab-pane p{ font-size: 16px;}

    .highlighted { color:#008000;font-size:15px !important;}
    .blueBorder {
        border: 3px solid #6090BD;
    }
</style>
<?php
$disableRemaining = false;
$rewards = '';
$emailWorkflow = '';
$campaign = '';
$reviews = '';
$integrationClass = '';
if ($setTab == 'Review Sources' || $selectedTab == 'Review Sources') {
    $rs = 'active';
} else if ($setTab == 'Campaign Preferences' || $selectedTab == 'Campaign Preferences') {
    $camp = 'active';
} else if (trim($setTab) == 'Rewards & Gifts' || $selectedTab == 'Rewards & Gifts') {
    $rewards = 'active';
} else if (trim($setTab) == 'Configure Widgets' || $selectedTab == 'Configure Widgets') {
    $setupClass = 'active';
} else if (trim($setTab) == 'Email Workflow' || $selectedTab == 'Email Workflow') {
    $emailWorkflow = 'active';
} else if (trim($setTab) == 'Clients' || $selectedTab == 'Clients') {
    $campaign = 'active';
} else if (trim($setTab) == 'Reviews' || $selectedTab == 'Reviews') {
    $reviews = 'active';
} else if (trim($setTab) == 'Integration' || $selectedTab == 'Integration') {
    $integrationClass = 'active';
} else if (trim($setTab) == 'Image' || $selectedTab == 'Image') {
    $imageClass = 'active';
} else if (trim($setTab) == 'Video' || $selectedTab == 'Video') {
    $videoClass = 'active';
} else {
    $rs = 'active';
}
?>
<div class="content">
    <div class="row mb20">

        <div class="col-lg-12 text-right">


            <button data-toggle="modal" data-target="#addSubscriber" type="button" class="btn bl_cust_btn btn-default" style="margin-left:12px;"><i class="icon-make-group position-left"></i> INVITE PEOPLE </button>

            <button data-toggle="modal" data-target="#importCSV" type="button" class="btn bl_cust_btn btn-default" style="margin-left:12px;"><i class="icon-make-group position-left"></i> IMPORT PEOPLE </button> 

            <form method="post" action="{{ base_url() }}admin/modules/nps/exportCSV" enctype="multipart/form-data" style="float:right; margin-left:15px;">
                <input type="hidden" name="nps_hash_id" id="nps_hash_id" value="<?php echo $oNPS->hashcode; ?>">
                <button type="submit" title="Export" class="btn bl_cust_btn btn-default" id="exportButton"><i class="icon-make-group position-left"></i> EXPORT PEOPLE </button>
            </form>


        </div>
    </div> 
    <div class="row">
        <div class="col-md-12">
            <div class="panel panel-flat">
                <div class="panel-heading">
                    <h6 class="panel-title">NPS Module Setup<?php echo (!empty($oNPS)) ? ': ' . $oNPS->title : ''; ?></h6>
                </div>
                <div class="panel-body">
                    <div class="tabbable">
                        <ul class="nav nav-tabs nav-tabs-bottom" id="nav-tabs-bottom">
                            <li class="<?php
                            if ($defalutTab == 'platform') {
                                echo 'active';
                            }
                            ?>"><a href="#right-icon-tab1" data-toggle="tab"><i class="fa fa-cog position-left"></i> Platform</a></li>

                            <li class="<?php
                            if ($defalutTab == 'customize') {
                                echo 'active';
                                $disableRemaining = true;
                            }
                            ?>"><a href="<?php
                                    if ($disableRemaining == false || $defalutTab == 'customize') {
                                        $bCustomizeTab = true;
                                        ?>#right-icon-tab2<?php } else { ?>javascript:void(0);<?php } ?>" data-toggle="tab"><i class="icon-cog3 position-left"></i> Customization</a></li>

                            <li class="<?php
                                    if ($defalutTab == 'workflow') {
                                        echo 'active';
                                        $disableRemaining = true;
                                    }
                                    ?>"><a href="<?php
                                if ($disableRemaining == false || $defalutTab == 'workflow') {
                                    $bWorkflowTab = true;
                                    ?>#right-icon-tab3<?php } else { ?>javascript:void(0);<?php } ?>" data-toggle="tab"><i class="icon-mention position-left"></i> Workflow</a></li>

                            <li class="<?php
                                    if ($defalutTab == 'people') {
                                        echo 'active';
                                        $disableRemaining = true;
                                    }
                                ?>"><a href="<?php
                                if ($disableRemaining == false || $defalutTab == 'people') {
                                    $bPeopleTab = true;
                                    ?>#right-icon-tab4<?php } else { ?>javascript:void(0);<?php } ?>" data-toggle="tab"><i class="icon-address-book position-left"></i> People</a></li>

                            <!-- <li class="<?php
                                    if ($defalutTab == 'score') {
                                        echo 'active';
                                        $disableRemaining = true;
                                    }
                                ?>"><a href="<?php
                            if ($disableRemaining == false || $defalutTab == 'score') {
                                $bScoreTab = true;
                                ?>#right-icon-tab5<?php } else { ?>javascript:void(0);<?php } ?>" data-toggle="tab"><i class=" position-left"></i> Score</a></li> -->

                            <li class="<?php
                            if ($defalutTab == 'widgets') {
                                echo 'active';
                                $disableRemaining = true;
                            }
                            ?>"><a href="<?php
                                if ($disableRemaining == false || $defalutTab == 'widgets') {
                                    $bWidgetTab = true;
                                    ?>#right-icon-tab6<?php } else { ?>javascript:void(0);<?php } ?>" data-toggle="tab"><i class="icon-mention position-left"></i> Widgets</a></li>



                        </ul>

                        <div class="tab-content">
                            <!--########################TAB 1 ##########################-->
                            <?php $this->load->view("admin/modules/nps/nps-tabs/choose-platform", array('userID' => $userID, 'defalutTab' => $defalutTab, 'programID' => $programID, 'oAccountSettings' => $oAccountSettings)); ?>
                            <!--########################TAB 2 ##########################-->
                            <?php if ($bCustomizeTab == true): ?>
                                <?php $this->load->view("admin/modules/nps/nps-tabs/customization", array('userID' => $userID, 'defalutTab' => $defalutTab, 'programID' => $programID, 'oNPS' => $oNPS)); ?>
                            <?php endif; ?>
                            <!--########################TAB 3 ##########################-->
                            <?php if ($bWidgetTab == true): ?>
                                <?php $this->load->view("admin/modules/nps/nps-tabs/widget_code", array('userID' => $userID, 'defalutTab' => $defalutTab, 'programID' => $programID, 'oNPS' => $oNPS)); ?>
                            <?php endif; ?>
                            <!--########################TAB 4 ##########################-->
                            <?php if ($bWorkflowTab == true): ?>
                                <?php $this->load->view("admin/modules/nps/nps-tabs/reward-workflow", array('userID' => $userID, 'defalutTab' => $defalutTab, 'programID' => $programID, 'oNPS' => $oNPS)); ?>
                            <?php endif; ?>
                            <!--########################TAB 5 ##########################--> 
                            <?php if ($bPeopleTab == true): ?>
                                <?php $this->load->view("admin/modules/nps/nps-tabs/contacts", array('userID' => $userID, 'defalutTab' => $defalutTab, 'programID' => $programID, 'oNPS' => $oNPS, 'oContacts' => $oContacts)); ?>
                            <?php endif; ?>
                            <!--########################TAB 6 ##########################--> 
                            <?php if ($bScoreTab == true): ?>
                                <?php $this->load->view("admin/modules/nps/nps-tabs/score", array('userID' => $userID, 'defalutTab' => $defalutTab, 'programID' => $programID, 'oNPS' => $oNPS)); ?>
                            <?php endif; ?>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="addSubscriber" class="modal fade">
    <div class="modal-dialog modal-md">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">×</button>
                <h5 class="modal-title"><i class="fa fa-user"></i>&nbsp; Contacts</h5>
            </div>
            <div class="modal-body">
                <div class="panel-body">

                    <form name="frmInviteCustomer" id="frmInviteCustomer" method="post" action="" >
                        <input type="hidden" name="userid" value="<?php echo $userID; ?>" />
                        <input type="hidden" name="bbaid" value="<?php echo $oNPS->hashcode; ?>" />
                        <div class="col-md-12">

                            <div class="form-group">
                                <label class="control-label">First Name</label>
                                <div class="">
                                    <input name="firstname" id="firstname" class="form-control" type="text" required="">
                                </div>

                            </div>

                            <div class="form-group">
                                <label class="control-label">Last Name</label>
                                <div class="">
                                    <input name="lastname" id="lastname" class="form-control" value="" type="text" required="">
                                </div>
                            </div>


                            <div class="form-group">
                                <label class="control-label">Email</label>
                                <div class="">
                                    <input name="email" id="email" value="" class="form-control" type="text" required="">
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label">Phone</label>
                                <div class="">
                                    <input name="phone" id="phone" value="" class="form-control" type="text">
                                </div>
                            </div>

                            <button class="btn btn-success pull-right" id="btnInvite" type="submit">
                                Invite Advocates
                            </button>

                        </div>
                    </form>

                </div>
            </div>
        </div>
    </div>
</div>


<div id="importCSV" class="modal fade">
    <div class="modal-dialog modal-md">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">×</button>
                <h5 class="modal-title"><i class="fa fa-user"></i>&nbsp; Invite via Import</h5>
            </div>
            <div class="modal-body">
                <div class="panel-body">
                    <form name="frmInviteBulkCustomer" id="frmInviteBulkCustomer"  method="post" action="" enctype="multipart/form-data" >
                        <input type="hidden" name="userid" value="<?php echo $userID; ?>" />
                        <input type="hidden" name="bbaid" value="<?php echo $oNPS->hashcode; ?>" />

                        <div class="col-md-8">
                            <strong> Upload a CSV file with customer contact details </strong> <br>
                            -Column 1 should be EMAIL<br>
                            -Column 2 should be FIRST_NAME<br>
                            Column 3 should be LAST_NAME<br>
                            Column 4 should be PHONE<br>                            

                        </div>

                        <div class="col-md-4">
                            <div class="fileupload">
                                <input type="file" name="userfile" id="ctrBrowse" accept=".csv, application/vnd.ms-excel" style="position:relative;top:50px;" />
                            </div>

                        </div>

                        <div class="clearfix"></div>

                        <button class="btn btn-success pull-right" id="btnBulkInvite" type="submit">
                            Import People
                        </button>



                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {

        $("#frmInviteCustomer").submit(function () {

            $('.overlaynew').show();
            var formData = new FormData($(this)[0]);
            $('#btnInvite').prop("disabled", true);
            $.ajax({
                url: '<?php echo base_url('admin/modules/nps/registerInvite'); ?>',
                type: "POST",
                data: formData,
                contentType: false,
                cache: false,
                processData: false,
                dataType: "json",
                success: function (data) {
                    $('.overlaynew').hide();
                    if (data.status == 'success') {

                        //alertMessageAndRedirect('User has been invited successfully.', window.location.href);
                        window.location.href = window.location.href;
                    } else {

                        alertMessage('Error: Some thing wrong!');
                        $('.overlaynew').hide();
                    }
                }
            });
            return false;
        });

        $("#frmInviteBulkCustomer").submit(function () {

            $('.overlaynew').show();

            var formData = new FormData($(this)[0]);


            $.ajax({
                url: '<?php echo base_url('admin/modules/nps/importInviteCSV'); ?>',
                type: "POST",
                data: formData,
                contentType: false,
                cache: false,
                processData: false,
                dataType: "json",
                success: function (data) {

                    if (data.status == 'success') {

                        //alertMessageAndRedirect('Users has been invited successfully.', window.location.href);
                        window.location.href = window.location.href;

                    } else {

                        alertMessage('Error: Some thing wrong!');
                        $('.overlaynew').hide();
                    }
                }
            });
            return false;
        });

        $("#publishNPSCampaign").click(function () {
            $.ajax({
                url: '<?php echo base_url('admin/modules/nps/publishNPSCampaign'); ?>',
                type: "POST",
                data: {'npsId': '<?php echo $oNPS->id; ?>'},
                dataType: "html",
                success: function (data) {
                    window.location.href = '<?php echo base_url("/admin/modules/nps/") ?>';
                }, error: function () {
                    alertMessage('Error: Some thing wrong!');
                }
            });
        });

    });
</script>	




